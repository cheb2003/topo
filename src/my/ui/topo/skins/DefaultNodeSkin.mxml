<?xml version="1.0"?>
<s:SparkSkin contentBackgroundColor="red" creationComplete="init()" xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" width="80" height="60">
    <fx:Metadata>
        <![CDATA[
        [HostComponent("my.ui.topo.Node")]
        ]]>
    </fx:Metadata>
	<fx:Script>
		<![CDATA[
            private var a1Playing:Boolean;
            private var isMouseOver:Boolean;

            private function init():void {
                addEventListener(MouseEvent.ROLL_OVER, rollOverHandler, false, 0, true);
                addEventListener(MouseEvent.ROLL_OUT, rollOutHandler, false, 0, true);
            }
            private function rollOutHandler(event:MouseEvent):void {
                if(a1Playing) {
                   p1.end()
                }
                if(isMouseOver){
                    p2.play()
                    isMouseOver = false;
                }


            }
           private function rollOverHandler(event:MouseEvent):void {
               if(a1Playing) {
                   p2.end()
               }
               if(!isMouseOver) {
                   p1.play();
                   isMouseOver = true
               }
           }

		]]>
	</fx:Script>
    <fx:Declarations>
        <s:Parallel id="p1">
            <s:Resize repeatCount="1" target="{this}" id="r1" widthFrom="{width}" heightFrom="{height}" heightTo="{height + 40}" widthTo="{width + 40}"/>
            <s:Animate id="a1" target="{this}" effectStart="{a1Playing = true}" effectEnd="{a1Playing = false}">
                <s:SimpleMotionPath property="x" valueFrom="{x}" valueTo="{x - 10}"/>
                <s:SimpleMotionPath property="y" valueFrom="{y}" valueTo="{y - 10}"/>
            </s:Animate>
        </s:Parallel>
        <s:Parallel id="p2">
            <s:Resize repeatCount="1" target="{this}"  widthFrom="{width}" heightFrom="{height}" heightTo="{height - 40}" widthTo="{width - 40}"/>
            <s:Animate target="{this}" effectStart="{a1Playing = true}" effectEnd="{a1Playing = false}">
                <s:SimpleMotionPath property="x" valueFrom="{x}" valueTo="{x + 10}"/>
                <s:SimpleMotionPath property="y" valueFrom="{y}" valueTo="{y + 10}"/>
            </s:Animate>
        </s:Parallel>
    </fx:Declarations>
	<s:transitions>
        <s:Transition fromState="normal" toState="mouseOver" autoReverse="true">


            <!--<s:Animate id="a1" target="{this}" effectStart="{a1Playing = true}" effectEnd="{a1Playing = false}">
                <s:SimpleMotionPath property="x" valueFrom="{x}" valueTo="{x - 10}"/>
                <s:SimpleMotionPath property="y" valueFrom="{y}" valueTo="{y - 10}"/>
                <s:SimpleMotionPath property="width" valueFrom="{width}" valueTo="{width + 20}"/>
                <s:SimpleMotionPath property="height" valueFrom="{height}" valueTo="{height + 20}"/>

            </s:Animate>-->
        </s:Transition>
        <s:Transition fromState="mouseOver" toState="normal" autoReverse="true">
            <s:Resize target="{this}" id="r2" widthFrom="{width + 20}" widthTo="{width}"/>
            <!--<s:Animate id="a2" target="{this}" effectStart="{a1Playing = true}" effectEnd="{a1Playing = false}">
                <s:SimpleMotionPath property="x" valueFrom="{x + 10}" valueTo="{x}"/>
                <s:SimpleMotionPath property="y" valueFrom="{y + 10}" valueTo="{y}"/>
                <s:SimpleMotionPath property="width" valueFrom="{width + 20}" valueTo="{width}"/>
                <s:SimpleMotionPath property="height" valueFrom="{height + 20}" valueTo="{height}"/>
            </s:Animate>-->
        </s:Transition>
    </s:transitions>
    <s:states>
        <s:State name="normal">
        </s:State>
        <s:State name="selectedAndShowLabel"/>
        <s:State name="selected"/>
        <s:State name="mouseOver"/>
    </s:states>

		<!--<s:Rect left="0" right="0" top="0" bottom="0">
			<s:stroke>
				<s:SolidColorStroke color="#FF0000" />
			</s:stroke>
			<s:fill>
				&lt;!&ndash;- @private &ndash;&gt;
				<s:SolidColor id="bgFill" color="#00ff33" color.mouseOver="#0000ff"/>
			</s:fill>
		</s:Rect>-->
	<s:BitmapImage
		source="{hostComponent.imageSource}" id="img" x="{x}" y="{y}" width="{this.width}" height="{this.height}"/>
    <s:Label text="test" x="{img.x}" y="{img.y+img.height+5}" width="{img.width}" textAlign="center" />



</s:SparkSkin>
